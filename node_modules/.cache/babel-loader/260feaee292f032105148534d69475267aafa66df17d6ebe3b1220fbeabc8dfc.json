{"ast":null,"code":"import React,{useState}from'react';import{useNavigate}from\"react-router-dom\";import{FidgetSpinner}from'react-loader-spinner';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const LoginForm=props=>{const navigate=useNavigate();const[email,setEmail]=useState('');const[pass,setPass]=useState('');const[error,setError]=useState('');const[loading,setLoading]=useState('');const handleSubmit=e=>{e.preventDefault();setError(null);setLoading(true);let success=false;let errorText='';const payload=JSON.stringify({email:email,password:pass});try{fetch(process.env.REACT_APP_API_URL_BASE+'/login/',{method:'POST',body:payload,headers:{'Content-Type':'application/json'}}).then(res=>{setLoading(false);console.log(res);if(!res.ok){errorText=\"Error: \"+res.status+' - ';setError(errorText);success=false;return res.json();}else{success=true;return res.json();}}).then(data=>{if(!success){for(const err in data.errors){for(const msg in data.errors[err])errorText+=data.errors[err][msg];}console.log(errorText);setError(errorText);}else{if(data.success){window.sessionStorage.setItem(\"auth\",true);window.sessionStorage.setItem(\"user_id\",data.user_id);window.sessionStorage.setItem(\"token\",data.token);navigate('/userprofile');}}}).catch(error=>{success=false;console.error(error);console.log(error.message);setError(error.message);setLoading(false);});if(success){setEmail('');setPass('');setError('Logged In Successfully!');setLoading(false);//Navigate to User Page\n}else{setError(errorText);setLoading(false);}}catch(error){setLoading(false);console.error(error);console.log('mike');setError('Error Registering - Check your information and try again');}};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Login\"}),/*#__PURE__*/_jsxs(\"form\",{className:\"login-form\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"email\",children:\"Email\"}),/*#__PURE__*/_jsx(\"input\",{required:true,value:email,onChange:e=>setEmail(e.target.value),type:\"email\",placeholder:\"email@email.com\",id:\"email\",name:\"email\"}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"password\",children:\"Password\"}),/*#__PURE__*/_jsx(\"input\",{required:true,value:pass,onChange:e=>setPass(e.target.value),type:\"password\",placeholder:\"*********\",id:\"password\",name:\"password\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Login\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-success\",children:/*#__PURE__*/_jsx(\"b\",{children:error})})]}),/*#__PURE__*/_jsx(\"button\",{className:\"link-btn\",onClick:()=>navigate('/register'),children:\"Don't have an account? Register here.\"}),/*#__PURE__*/_jsx(\"p\",{children:loading?/*#__PURE__*/_jsx(FidgetSpinner,{}):''})]});};export default LoginForm;","map":{"version":3,"names":["React","useState","useNavigate","FidgetSpinner","jsx","_jsx","jsxs","_jsxs","LoginForm","props","navigate","email","setEmail","pass","setPass","error","setError","loading","setLoading","handleSubmit","e","preventDefault","success","errorText","payload","JSON","stringify","password","fetch","process","env","REACT_APP_API_URL_BASE","method","body","headers","then","res","console","log","ok","status","json","data","err","errors","msg","window","sessionStorage","setItem","user_id","token","catch","message","children","className","onSubmit","htmlFor","required","value","onChange","target","type","placeholder","id","name","onClick"],"sources":["C:/Users/mdj72/source/Ensign/cs415/cs415_website/src/Components/LoginForm.jsx"],"sourcesContent":["import React, { useState } from 'react';\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport { FidgetSpinner } from 'react-loader-spinner';\r\n\r\n\r\nconst LoginForm = (props) => {\r\n    const navigate = useNavigate();\r\n    const [email, setEmail] = useState('');\r\n    const [pass, setPass] = useState('');\r\n    const [error, setError] = useState('');\r\n    const [loading, setLoading] = useState('');\r\n\r\n    const handleSubmit = (e) => {\r\n      e.preventDefault();\r\n      setError(null)\r\n      setLoading(true)\r\n      let success = false\r\n      let errorText = ''\r\n      const payload = JSON.stringify({\r\n          email: email,\r\n          password: pass\r\n      })\r\n      try {\r\n          fetch(process.env.REACT_APP_API_URL_BASE + '/login/',{\r\n          method: 'POST',\r\n          body: payload,\r\n          headers:{\r\n              'Content-Type': 'application/json'\r\n              }\r\n          }).then((res) => {\r\n                setLoading(false)\r\n                console.log(res)\r\n                  if (!res.ok){\r\n                      errorText = \"Error: \" + res.status + ' - '\r\n                      setError(errorText)\r\n                      success = false\r\n                      return res.json()\r\n                  }\r\n                  else {\r\n                      success = true\r\n                      return res.json()\r\n                  }\r\n               }\r\n            ).then(data => {\r\n              if (!success) {\r\n                  for (const err in data.errors){\r\n                  for (const msg in data.errors[err]) errorText += data.errors[err][msg]\r\n                  }\r\n                  console.log(errorText)\r\n                  setError(errorText)\r\n              }\r\n              else{\r\n                if (data.success){\r\n                  window.sessionStorage.setItem(\"auth\", true)\r\n                  window.sessionStorage.setItem(\"user_id\", data.user_id)\r\n                  window.sessionStorage.setItem(\"token\", data.token)\r\n                  navigate('/userprofile')\r\n                }\r\n              }\r\n\r\n          })\r\n          .catch(error => {\r\n              success = false\r\n              console.error(error)\r\n              console.log(error.message)\r\n              setError(error.message)\r\n              setLoading(false)\r\n          });\r\n          if (success) {\r\n              setEmail('')\r\n              setPass('')\r\n              setError('Logged In Successfully!')\r\n              setLoading(false)\r\n              //Navigate to User Page\r\n\r\n          }\r\n          else{\r\n              setError(errorText)\r\n              setLoading(false)\r\n          }\r\n      } catch (error) {\r\n        setLoading(false)\r\n          console.error(error);\r\n          console.log('mike')\r\n          setError('Error Registering - Check your information and try again')\r\n      }\r\n    }\r\n    return (\r\n    <div >\r\n      <h2>Login</h2>\r\n            <form className=\"login-form\" onSubmit={handleSubmit}>\r\n                <label htmlFor=\"email\">Email</label>\r\n                <input required value={email} onChange={(e) => setEmail(e.target.value)} type=\"email\" placeholder=\"email@email.com\" id=\"email\" name=\"email\"/>\r\n                <label htmlFor=\"password\">Password</label>\r\n                <input required value={pass} onChange={(e) => setPass(e.target.value)} type=\"password\" placeholder=\"*********\" id=\"password\" name=\"password\"/>\r\n                <button type=\"submit\">Login</button>\r\n                <p className=\"text-success\"><b>{error}</b></p>\r\n            </form>\r\n            <button className=\"link-btn\" onClick={() => navigate('/register')}>Don't have an account? Register here.</button>\r\n            <p>{loading ? <FidgetSpinner /> : ''}</p>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default LoginForm;\r\n\r\n\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}