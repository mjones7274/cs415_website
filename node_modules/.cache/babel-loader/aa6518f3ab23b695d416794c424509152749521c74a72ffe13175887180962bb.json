{"ast":null,"code":"import React,{useState}from'react';import{useNavigate}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const LoginForm=props=>{const navigate=useNavigate();const[email,setEmail]=useState('');const[pass,setPass]=useState('');const[error,setError]=useState('');const handleSubmit=e=>{e.preventDefault();setError(null);let success=true;let errorText='';const payload=JSON.stringify({email:email,password:pass});try{fetch(process.env.REACT_APP_API_URL_BASE+'/login/',{method:'POST',body:payload,headers:{'Content-Type':'application/json'}}).then(res=>{if(!res.ok){errorText=\"Error: \"+res.status+' - ';success=false;return res.json();}else{success=true;return res.json();}}).then(data=>{if(!success){for(const err in data.errors){for(const msg in data.errors[err])errorText+=data.errors[err][msg];}console.log(errorText);setError(errorText);}else{if(data.success){window.sessionStorage.setItem(\"auth\",true);window.sessionStorage.setItem(\"user_id\",data.user_id);window.sessionStorage.setItem(\"token\",data.token);navigate('/userprofile');}}}).catch(error=>{success=false;console.error(error);});if(success){setEmail('');setPass('');setError('Logged In Successfully!');//Navigate to User Page\n}else{setError(errorText);}}catch(error){console.error(error);setError('Error Registering - Check your information and try again');}};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Login\"}),/*#__PURE__*/_jsxs(\"form\",{className:\"login-form\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"email\",children:\"Email\"}),/*#__PURE__*/_jsx(\"input\",{required:true,value:email,onChange:e=>setEmail(e.target.value),type:\"email\",placeholder:\"email@email.com\",id:\"email\",name:\"email\"}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"password\",children:\"Password\"}),/*#__PURE__*/_jsx(\"input\",{required:true,value:pass,onChange:e=>setPass(e.target.value),type:\"password\",placeholder:\"*********\",id:\"password\",name:\"password\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Login\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-success\",children:/*#__PURE__*/_jsx(\"b\",{children:error})})]}),/*#__PURE__*/_jsx(\"button\",{className:\"link-btn\",onClick:()=>navigate('/register'),children:\"Don't have an account? Register here.\"})]});};export default LoginForm;","map":{"version":3,"names":["React","useState","useNavigate","jsx","_jsx","jsxs","_jsxs","LoginForm","props","navigate","email","setEmail","pass","setPass","error","setError","handleSubmit","e","preventDefault","success","errorText","payload","JSON","stringify","password","fetch","process","env","REACT_APP_API_URL_BASE","method","body","headers","then","res","ok","status","json","data","err","errors","msg","console","log","window","sessionStorage","setItem","user_id","token","catch","children","className","onSubmit","htmlFor","required","value","onChange","target","type","placeholder","id","name","onClick"],"sources":["C:/Users/mdj72/source/Ensign/cs415/cs415_website/src/Components/LoginForm.jsx"],"sourcesContent":["import React, { useState } from 'react';\r\nimport { useNavigate } from \"react-router-dom\"\r\n\r\nconst LoginForm = (props) => {\r\n    const navigate = useNavigate();\r\n    const [email, setEmail] = useState('');\r\n    const [pass, setPass] = useState('');\r\n    const [error, setError] = useState('');\r\n\r\n    const handleSubmit = (e) => {\r\n      e.preventDefault();\r\n      setError(null)\r\n      let success = true\r\n      let errorText = ''\r\n      const payload = JSON.stringify({\r\n          email: email,\r\n          password: pass\r\n      })\r\n      try {\r\n          fetch(process.env.REACT_APP_API_URL_BASE + '/login/',{\r\n          method: 'POST',\r\n          body: payload,\r\n          headers:{\r\n              'Content-Type': 'application/json'\r\n              }\r\n          }).then(res => {\r\n                  if (!res.ok){\r\n                      errorText = \"Error: \" + res.status + ' - '\r\n                      success = false\r\n                      return res.json()\r\n                  }\r\n                  else {\r\n                      success = true\r\n                      return res.json()\r\n                  }\r\n               }\r\n            ).then(data => {\r\n              if (!success) {\r\n                  for (const err in data.errors){\r\n                  for (const msg in data.errors[err]) errorText += data.errors[err][msg]\r\n                  }\r\n                  console.log(errorText)\r\n                  setError(errorText)\r\n              }\r\n              else{\r\n                if (data.success){\r\n                  window.sessionStorage.setItem(\"auth\", true)\r\n                  window.sessionStorage.setItem(\"user_id\", data.user_id)\r\n                  window.sessionStorage.setItem(\"token\", data.token)\r\n                  navigate('/userprofile')\r\n                }\r\n              }\r\n\r\n          })\r\n          .catch(error => {\r\n              success = false\r\n              console.error(error)\r\n          });\r\n          if (success) {\r\n              setEmail('')\r\n              setPass('')\r\n              setError('Logged In Successfully!')\r\n              //Navigate to User Page\r\n\r\n          }\r\n          else{\r\n              setError(errorText)\r\n          }\r\n      } catch (error) {\r\n          console.error(error);\r\n          setError('Error Registering - Check your information and try again')\r\n      }\r\n    }\r\n    return (\r\n    <div >\r\n      <h2>Login</h2>\r\n            <form className=\"login-form\" onSubmit={handleSubmit}>\r\n                <label htmlFor=\"email\">Email</label>\r\n                <input required value={email} onChange={(e) => setEmail(e.target.value)} type=\"email\" placeholder=\"email@email.com\" id=\"email\" name=\"email\"/>\r\n                <label htmlFor=\"password\">Password</label>\r\n                <input required value={pass} onChange={(e) => setPass(e.target.value)} type=\"password\" placeholder=\"*********\" id=\"password\" name=\"password\"/>\r\n                <button type=\"submit\">Login</button>\r\n                <p className=\"text-success\"><b>{error}</b></p>\r\n            </form>\r\n            <button className=\"link-btn\" onClick={() => navigate('/register')}>Don't have an account? Register here.</button>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default LoginForm;\r\n\r\n\r\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,KAAQ,OAAO,CACvC,OAASC,WAAW,KAAQ,kBAAkB,QAAAC,GAAA,IAAAC,IAAA,gCAAAC,IAAA,IAAAC,KAAA,yBAE9C,KAAM,CAAAC,SAAS,CAAIC,KAAK,EAAK,CACzB,KAAM,CAAAC,QAAQ,CAAGP,WAAW,CAAC,CAAC,CAC9B,KAAM,CAACQ,KAAK,CAAEC,QAAQ,CAAC,CAAGV,QAAQ,CAAC,EAAE,CAAC,CACtC,KAAM,CAACW,IAAI,CAAEC,OAAO,CAAC,CAAGZ,QAAQ,CAAC,EAAE,CAAC,CACpC,KAAM,CAACa,KAAK,CAAEC,QAAQ,CAAC,CAAGd,QAAQ,CAAC,EAAE,CAAC,CAEtC,KAAM,CAAAe,YAAY,CAAIC,CAAC,EAAK,CAC1BA,CAAC,CAACC,cAAc,CAAC,CAAC,CAClBH,QAAQ,CAAC,IAAI,CAAC,CACd,GAAI,CAAAI,OAAO,CAAG,IAAI,CAClB,GAAI,CAAAC,SAAS,CAAG,EAAE,CAClB,KAAM,CAAAC,OAAO,CAAGC,IAAI,CAACC,SAAS,CAAC,CAC3Bb,KAAK,CAAEA,KAAK,CACZc,QAAQ,CAAEZ,IACd,CAAC,CAAC,CACF,GAAI,CACAa,KAAK,CAACC,OAAO,CAACC,GAAG,CAACC,sBAAsB,CAAG,SAAS,CAAC,CACrDC,MAAM,CAAE,MAAM,CACdC,IAAI,CAAET,OAAO,CACbU,OAAO,CAAC,CACJ,cAAc,CAAE,kBAChB,CACJ,CAAC,CAAC,CAACC,IAAI,CAACC,GAAG,EAAI,CACP,GAAI,CAACA,GAAG,CAACC,EAAE,CAAC,CACRd,SAAS,CAAG,SAAS,CAAGa,GAAG,CAACE,MAAM,CAAG,KAAK,CAC1ChB,OAAO,CAAG,KAAK,CACf,MAAO,CAAAc,GAAG,CAACG,IAAI,CAAC,CAAC,CACrB,CAAC,IACI,CACDjB,OAAO,CAAG,IAAI,CACd,MAAO,CAAAc,GAAG,CAACG,IAAI,CAAC,CAAC,CACrB,CACH,CACH,CAAC,CAACJ,IAAI,CAACK,IAAI,EAAI,CACb,GAAI,CAAClB,OAAO,CAAE,CACV,IAAK,KAAM,CAAAmB,GAAG,GAAI,CAAAD,IAAI,CAACE,MAAM,CAAC,CAC9B,IAAK,KAAM,CAAAC,GAAG,GAAI,CAAAH,IAAI,CAACE,MAAM,CAACD,GAAG,CAAC,CAAElB,SAAS,EAAIiB,IAAI,CAACE,MAAM,CAACD,GAAG,CAAC,CAACE,GAAG,CAAC,CACtE,CACAC,OAAO,CAACC,GAAG,CAACtB,SAAS,CAAC,CACtBL,QAAQ,CAACK,SAAS,CAAC,CACvB,CAAC,IACG,CACF,GAAIiB,IAAI,CAAClB,OAAO,CAAC,CACfwB,MAAM,CAACC,cAAc,CAACC,OAAO,CAAC,MAAM,CAAE,IAAI,CAAC,CAC3CF,MAAM,CAACC,cAAc,CAACC,OAAO,CAAC,SAAS,CAAER,IAAI,CAACS,OAAO,CAAC,CACtDH,MAAM,CAACC,cAAc,CAACC,OAAO,CAAC,OAAO,CAAER,IAAI,CAACU,KAAK,CAAC,CAClDtC,QAAQ,CAAC,cAAc,CAAC,CAC1B,CACF,CAEJ,CAAC,CAAC,CACDuC,KAAK,CAAClC,KAAK,EAAI,CACZK,OAAO,CAAG,KAAK,CACfsB,OAAO,CAAC3B,KAAK,CAACA,KAAK,CAAC,CACxB,CAAC,CAAC,CACF,GAAIK,OAAO,CAAE,CACTR,QAAQ,CAAC,EAAE,CAAC,CACZE,OAAO,CAAC,EAAE,CAAC,CACXE,QAAQ,CAAC,yBAAyB,CAAC,CACnC;AAEJ,CAAC,IACG,CACAA,QAAQ,CAACK,SAAS,CAAC,CACvB,CACJ,CAAE,MAAON,KAAK,CAAE,CACZ2B,OAAO,CAAC3B,KAAK,CAACA,KAAK,CAAC,CACpBC,QAAQ,CAAC,0DAA0D,CAAC,CACxE,CACF,CAAC,CACD,mBACAT,KAAA,QAAA2C,QAAA,eACE7C,IAAA,OAAA6C,QAAA,CAAI,OAAK,CAAI,CAAC,cACR3C,KAAA,SAAM4C,SAAS,CAAC,YAAY,CAACC,QAAQ,CAAEnC,YAAa,CAAAiC,QAAA,eAChD7C,IAAA,UAAOgD,OAAO,CAAC,OAAO,CAAAH,QAAA,CAAC,OAAK,CAAO,CAAC,cACpC7C,IAAA,UAAOiD,QAAQ,MAACC,KAAK,CAAE5C,KAAM,CAAC6C,QAAQ,CAAGtC,CAAC,EAAKN,QAAQ,CAACM,CAAC,CAACuC,MAAM,CAACF,KAAK,CAAE,CAACG,IAAI,CAAC,OAAO,CAACC,WAAW,CAAC,iBAAiB,CAACC,EAAE,CAAC,OAAO,CAACC,IAAI,CAAC,OAAO,CAAC,CAAC,cAC7IxD,IAAA,UAAOgD,OAAO,CAAC,UAAU,CAAAH,QAAA,CAAC,UAAQ,CAAO,CAAC,cAC1C7C,IAAA,UAAOiD,QAAQ,MAACC,KAAK,CAAE1C,IAAK,CAAC2C,QAAQ,CAAGtC,CAAC,EAAKJ,OAAO,CAACI,CAAC,CAACuC,MAAM,CAACF,KAAK,CAAE,CAACG,IAAI,CAAC,UAAU,CAACC,WAAW,CAAC,WAAW,CAACC,EAAE,CAAC,UAAU,CAACC,IAAI,CAAC,UAAU,CAAC,CAAC,cAC9IxD,IAAA,WAAQqD,IAAI,CAAC,QAAQ,CAAAR,QAAA,CAAC,OAAK,CAAQ,CAAC,cACpC7C,IAAA,MAAG8C,SAAS,CAAC,cAAc,CAAAD,QAAA,cAAC7C,IAAA,MAAA6C,QAAA,CAAInC,KAAK,CAAI,CAAC,CAAG,CAAC,EAC5C,CAAC,cACPV,IAAA,WAAQ8C,SAAS,CAAC,UAAU,CAACW,OAAO,CAAEA,CAAA,GAAMpD,QAAQ,CAAC,WAAW,CAAE,CAAAwC,QAAA,CAAC,uCAAqC,CAAQ,CAAC,EACpH,CAAC,CAEV,CAAC,CAED,cAAe,CAAA1C,SAAS"},"metadata":{},"sourceType":"module","externalDependencies":[]}